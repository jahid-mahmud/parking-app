<!DOCTYPE html>
<html>

<head>
</head>

<body>
  <div id="ball"
    style="background-color:green;position:absolute;top:0px;left:0px;width:250px;height:250px;z-index:9999;box-shadow: 6px 6px 5px #888888;border-radius:6px;border:1px solid #4f4f4f;">

    <p>Content of the popup</p>
  </div>
</body>
<script>
  var initialTop;
  var initialLeft;    
  ball.onmousedown = function (event) {
    console.log(ball);
    var offsets = document.getElementById('ball').getBoundingClientRect();
    var initialTop = offsets.top;
    var initialLeft = offsets.left;
    let shiftX = event.clientX - ball.getBoundingClientRect().left;
    let shiftY = event.clientY - ball.getBoundingClientRect().top;
    console.log("initial position", initialTop, initialLeft)

    ball.style.position = 'absolute';
    ball.style.zIndex = 1000;
    document.body.append(ball);

    moveAt(event.pageX, event.pageY);

    function moveAt(pageX, pageY) {
      ball.style.left = pageX - shiftX + 'px';
      ball.style.top = pageY - shiftY + 'px';
    }

    function onMouseMove(event) {
      moveAt(event.pageX, event.pageY);
      ball.hidden = true;
      let elemBelow = document.elementFromPoint(event.clientX, event.clientY);
      ball.hidden = false;
      if (!elemBelow) return;
    }

    document.addEventListener('mousemove', onMouseMove);

    ball.onmouseup = function () {
      var offsets = document.getElementById('ball').getBoundingClientRect();
      var top = offsets.top;
      var left = offsets.left;
      console.log("top-left", top, left);
      offsets.top=initialTop;
      offsets.left=initialLeft;
      document.removeEventListener('mousemove', onMouseMove);
      ball.onmouseup = null;

    };

  };

  function enterDroppable(elem) {
    elem.style.background = 'pink';
  }

  function leaveDroppable(elem) {
    elem.style.background = '';
  }

  ball.ondragstart = function () {
    return false;
  };

// !function() {
//   function addListener(element, type, callback, capture) {
//     if (element.addEventListener) {
//       element.addEventListener(type, callback, capture);
//     } else {
//       element.attachEvent("on" + type, callback);
//     }
//   }

//   function draggable(element) {
//     var dragging = null;

//     addListener(element, "mousedown", function(e) {
//       var e = window.event || e;
//       dragging = {
//         mouseX: e.clientX,
//         mouseY: e.clientY,
//         startX: parseInt(element.style.left),
//         startY: parseInt(element.style.top)
//       };
//       if (element.setCapture) element.setCapture();
//     });

//     addListener(element, "losecapture", function() {
//       dragging = null;
//     });

//     addListener(document, "mouseup", function(e) {
//         var e = window.event || e;
//         dragging = {
//         mouseX: e.clientX,
//         mouseY: e.clientY,
//         startX: parseInt(element.style.left),
//         startY: parseInt(element.style.top)
//       };
//       debugger;
//       dragging = null;
//       if (document.releaseCapture) document.releaseCapture();
//     }, true);

//     var dragTarget = element.setCapture ? element : document;

//     addListener(dragTarget, "mousemove", function(e) {
//       if (!dragging) return;

//       var e = window.event || e;
//       var top = dragging.startY + (e.clientY - dragging.mouseY);
//       var left = dragging.startX + (e.clientX - dragging.mouseX);

//       element.style.top = (Math.max(0, top)) + "px";
//       element.style.left = (Math.max(0, left)) + "px";
//     }, true);
//   };    

//   draggable(document.getElementById("popup"));
// }();
//   </script>

</html>